# -*- coding: utf-8 -*-
"""
Robot in a Grid

Imagine a robot sitting on the upper left corner of grid with r rows and c columns. The robot can
only move in two directions, right and down, but certain cells are "off limits" such that the robot
cannot step on them. Design an algorithm to find a path for the robot from the top left to the
bottom right.

"""
import unittest


def find_path(rows, cols, off_limits):
    """

    Args:
        r:
        c:
        off_limits:

    Returns:

    """
    if not (rows > 0 and cols > 0):
        return []    
    
    last_row = rows - 1
    last_col = cols - 1
    
    DOWN = 1
    RIGHT = 2
    FINISH = 3
    
    path_matrix = [[None] * cols] * rows
    off_limits = set(off_limits)
    
    if (last_row, last_col) in off_limits:
        return []    
    path_matrix[last_row, last_col] = FINISH
    
    for r in range(last_row, -1, -1):
        for c in range(last_col, -1, -1):
            if (r, c) in off_limits:
                continue            
            if r < last_row and path_matrix[r + 1, c]:
                path_matrix[r, c] = DOWN
                continue
            if c < last_col and path_matrix[r, c + 1]:
                path_matrix[r, c] = RIGHT
    
    if not path_matrix[0, 0]:
        return []
    
    path = []    
    r, c = 0, 0
    while len(path) < rows + cols - 1:
        path.append((r, c))
        if path_matrix[r, c] == DOWN:
            r += 1
        else:
            c += 1
    
    return path


class TestFindPath(unittest.TestCase):
    data = [
        (0, 0, [], []),
        (1, 1, [], [(0, 0)]),
        (1, 1, [(0, 0)], []),
        (1, 2, [], [(0, 0), (0, 1)]),
        (1, 2, [(0, 0)], []),
        (1, 2, [(0, 1)], []),
        (1, 2, [(0, 0), (0, 1)], []),
        (2, 1, [], [(0, 0), (1, 0)]),
        (2, 1, [(0, 0)], []),
        (2, 1, [(1, 0)], []),
        (2, 1, [(0, 0), (1, 0)], []),
        (2, 2, [], [(0, 0), (1, 0), (1, 1)]),
        (2, 2, [(0, 0)], []),
        (2, 2, [(0, 1)], [(0, 0), (1, 0), (1, 1)]),
        (2, 2, [(1, 0)], [(0, 0), (0, 1), (1, 1)]),
        (2, 2, [(1, 1)], []),
        (2, 2, [(0, 1), (1, 0)], []),
        (2, 2, [(0, 1), (1, 1)], []),
        (2, 3, [], [(0, 0), (1, 0), (1, 1), (1, 2)]),
        (2, 3, [(1, 0)], [(0, 0), (0, 1), (1, 1), (1, 2)]),
        (2, 3, [(1, 1)], [(0, 0), (0, 1), (0, 2), (1, 2)]),
        (2, 3, [(0, 1), (1, 1)], []),
        (2, 3, [(1, 2)], []),
        (3, 2, [], [(0, 0), (1, 0), (2, 0), (2, 1)]),
        (3, 2, [(1, 0)], [(0, 0), (0, 1), (1, 1), (2, 1)]),
        (3, 2, [(2, 0)], [(0, 0), (1, 0), (1, 1), (2, 1)]),
        (3, 2, [(1, 1)], [(0, 0), (1, 0), (2, 0), (2, 1)]),
        (3, 2, [(1, 0), (1, 1)], []),
        (3, 2, [(1, 0), (2, 0)], [(0, 0), (0, 1), (1, 1), (2, 1)]),
        (3, 2, [(1, 1), (2, 0)], []),
        (3, 3, [], [(0, 0), (1, 0), (2, 0), (2, 1), (2, 2)]),
        (3, 3, [(0, 0)], []),
        (3, 3, [(1, 0)], [(0, 0), (0, 1), (1, 1), (2, 1), (2, 2)]),
        (3, 3, [(1, 1)], [(0, 0), (1, 0), (2, 0), (2, 1), (2, 2)]),
        (3, 3, [(2, 1)], [(0, 0), (1, 0), (1, 1), (1, 2), (2, 2)]),
        (3, 3, [(0, 1), (1, 0)], []),
        (3, 3, [(1, 0), (1, 2)], [(0, 0), (0, 1), (1, 1), (2, 1), (2, 2)]),
        (3, 3, [(1, 2), (2, 1)], []),
        (3, 3, [(1, 0), (2, 1)], [(0, 0), (0, 1), (1, 1), (1, 2), (2, 2)]),
        (3, 3, [(1, 0), (1, 1), (1, 2)], []),
        (3, 3, [(1, 0), (1, 1), (2, 1)], [(0, 0), (0, 1), (0, 2), (1, 2), (2, 2)]),
        (3, 3, [(1, 0), (1, 2), (2, 1)], []),
        (3, 3, [(0, 1), (2, 0), (2, 1)], [(0, 0), (1, 0), (1, 1), (1, 2), (2, 2)]),
        (3, 3, [(0, 1), (0, 2), (1, 2), (2, 0)], [(0, 0), (1, 0), (1, 1), (2, 1), (2, 2)]),
        (3, 3, [(0, 1), (0, 2), (1, 1), (2, 0)], []),
        (2, 4, [(1, 1)], [(0, 0), (0, 1), (0, 2), (1, 2), (1, 3)]),
        (2, 4, [(0, 2), (1, 1)], []),
        (2, 4, [(0, 3), (1, 1)], [(0, 0), (0, 1), (0, 2), (1, 2), (1, 3)]),
        (2, 4, [(0, 0), (1, 3)], []),
        (3, 4, [(1, 2), (2, 0), (2, 2)], [(0, 0), (0, 1), (0, 2), (0, 3), (1, 3), (2, 3)]),
        (3, 4, [(0, 3), (2, 0)], [(0, 0), (1, 0), (1, 1), (2, 1), (2, 2), (2, 3)]),
        (3, 4, [(0, 2), (1, 1), (2, 2)], []),
        (3, 4, [(1, 1), (2, 2)], [(0, 0), (0, 1), (0, 2), (1, 2), (1, 3), (2, 3)]),
        (4, 2, [(0, 1), (1, 1), (3, 0)], [(0, 0), (1, 0), (2, 0), (2, 1), (3, 1)]),
        (4, 2, [(1, 1), (2, 0)], []),
        (4, 2, [(0, 1), (2, 1)], [(0, 0), (1, 0), (2, 0), (3, 0), (3, 1)]),
        (4, 3, [(2, 1), (3, 0)], [(0, 0), (1, 0), (1, 1), (1, 2), (2, 2), (3, 2)]),
        (4, 3, [(1, 1), (1, 2), (3, 1)], [(0, 0), (1, 0), (2, 0), (2, 1), (2, 2), (3, 2)]),
        (4, 3, [(1, 1), (2, 1), (2, 2), (3, 0)], []),
        (4, 4, [(3, 3)], []),
        (4, 4, [(1, 0), (1, 3), (2, 1)], [(0, 0), (0, 1), (1, 1), (1, 2), (2, 2), (3, 2), (3, 3)]),
        (4, 4, [(2, 2), (2, 3), (3, 2)], []),
        (4, 4, [(0, 1), (2, 0), (2, 2), (3, 2)],
         [(0, 0), (1, 0), (1, 1), (1, 2), (1, 3), (2, 3), (3, 3)]),
        (4, 4, [(1, 2), (1, 3), (2, 1), (3, 0), (3, 1)], []),
        (4, 4, [(1, 0), (1, 1), (2, 1), (2, 3)],
         [(0, 0), (0, 1), (0, 2), (1, 2), (2, 2), (3, 2), (3, 3)]),
        (4, 4, [(1, 0), (2, 1), (3, 2)], [(0, 0), (0, 1), (1, 1), (1, 2), (2, 2), (2, 3), (3, 3)]),
        (4, 4, [(0, 2), (0, 3), (1, 0), (1, 2), (1, 3), (2, 0), (3, 0), (3, 1), (3, 2)],
         [(0, 0), (0, 1), (1, 1), (2, 1), (2, 2), (2, 3), (3, 3)]),
        (1, 5, [], [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]),
        (1, 5, [(0, 2)], []),
        (1, 5, [(0, 0)], []),
        (3, 5, [(0, 3), (1, 2), (1, 4), (2, 0)],
         [(0, 0), (1, 0), (1, 1), (2, 1), (2, 2), (2, 3), (2, 4)]),
        (3, 5, [(0, 4), (1, 1), (1, 3), (2, 1)],
         [(0, 0), (0, 1), (0, 2), (1, 2), (2, 2), (2, 3), (2, 4)]),
        (3, 5, [(0, 3), (1, 2), (2, 1)], []),
        (5, 1, [], [(0, 0), (1, 0), (2, 0), (3, 0), (4, 0)]),
        (5, 1, [(1, 0), (3, 0)], []),
        (5, 2, [], [(0, 0), (1, 0), (2, 0), (3, 0), (4, 0), (4, 1)]),
        (5, 2, [(2, 0), (3, 0), (4, 0)], [(0, 0), (1, 0), (1, 1), (2, 1), (3, 1), (4, 1)]),
        (5, 2, [(0, 1), (2, 1), (4, 0)], [(0, 0), (1, 0), (2, 0), (3, 0), (3, 1), (4, 1)]),
        (5, 2, [(1, 1), (2, 0)], []),
        (5, 3, [(1, 1), (3, 1), (4, 1)], [(0, 0), (1, 0), (2, 0), (2, 1), (2, 2), (3, 2), (4, 2)]),
        (5, 5, [(0, 4), (1, 3), (3, 1), (3, 3), (4, 0)],
         [(0, 0), (1, 0), (2, 0), (2, 1), (2, 2), (3, 2), (4, 2), (4, 3), (4, 4)]),
        (5, 5, [(1, 1), (1, 3), (3, 1), (3, 3), (4, 0), (4, 2)],
         [(0, 0), (1, 0), (2, 0), (2, 1), (2, 2), (2, 3), (2, 4), (3, 4), (4, 4)]),
        (5, 5, [(0, 2), (1, 1), (1, 3), (2, 3), (3, 1), (3, 2), (3, 3), (4, 0), (4, 1)], []),
        (5, 5, [(1, 0), (1, 2), (1, 4), (2, 2), (3, 1), (3, 2), (3, 3)],
         [(0, 0), (0, 1), (0, 2), (0, 3), (1, 3), (2, 3), (2, 4), (3, 4), (4, 4)]),
        (5, 5, [(1, 0), (1, 1), (3, 2), (3, 3), (3, 4)], []),
        (5, 5, [(1, 0), (1, 2), (1, 4), (3, 1), (3, 3)],
         [(0, 0), (0, 1), (1, 1), (2, 1), (2, 2), (3, 2), (4, 2), (4, 3), (4, 4)]),
        (6, 6, [(1, 0), (1, 2), (1, 4), (3, 1), (3, 3), (3, 5), (5, 0), (5, 2), (5, 4)],
         [(0, 0), (0, 1), (1, 1), (2, 1), (2, 2), (3, 2), (4, 2), (4, 3), (4, 4), (4, 5), (5, 5)]),
        (6, 6, [(0, 4), (1, 2), (2, 2), (2, 4), (3, 0), (3, 1), (3, 2), (4, 4), (4, 5)],
         [(0, 0), (0, 1), (0, 2), (0, 3), (1, 3), (2, 3), (3, 3), (4, 3), (5, 3), (5, 4), (5, 5)]),
        (6, 6, [(1, 0), (1, 2), (1, 3), (2, 2), (2, 4), (3, 1), (3, 2), (4, 4), (4, 5)], []),
        (6, 6, [(0, 1), (0, 3), (0, 5), (2, 1), (2, 3), (2, 5), (4, 1), (4, 3), (4, 5)],
         [(0, 0), (1, 0), (2, 0), (3, 0), (4, 0), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)]),
        (6, 6, [(1, 1), (2, 0), (2, 3), (3, 2), (3, 5), (4, 4)], []),
        (6, 6, [(1, 1), (1, 2), (1, 3), (1, 4), (2, 4), (3, 4), (4, 0), (4, 1), (4, 3),(4, 4)],
         [(0, 0), (1, 0), (2, 0), (3, 0), (3, 1), (3, 2), (4, 2), (5, 2), (5, 3), (5, 4), (5, 5)])
    ]
